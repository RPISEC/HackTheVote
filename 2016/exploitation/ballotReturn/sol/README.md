Ballot Return
---

This challenge is based on an Android root exploit from awhile back.

The bug is in not checking the return value of setuid(). To exploit this bug you need to 
get the setuid() call to fail, you will then be dropped to a privileged shell.
A maximum number of processes NPROC is configured in /etc/limits.h for the user, if this
maximum is reached then the setuid() call will fail to drop privileges.


1. Connect and `ctrl-d` to escape the voting prompt and get an unprivileged shell
2. Connect again and wait at the voting prompt.
3. Use your unprivileged shell to bring NPROC to the limit.
4. Escape the voting prompt again to be dropped to a privileged shell

NOTE: Since linux 3.1 setuid will not fail from NPROC, but instead will fail at the exec/fork, so this challenge needs to run on pre-3.1 linux.
